<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>merge_request_approvals API Documentation</title>
</head>
<body>
<hr />
<p>stage: Create
group: Code Review
info: "To determine the technical writer assigned to the Stage/Group associated with this page, see https://handbook.gitlab.com/handbook/product/ux/technical-writing/#assignments"
description: "Documentation for the REST API for merge request approvals in GitLab."</p>
<hr />
<h1>Merge request approvals API</h1>
<p>DETAILS:
<strong>Tier:</strong> Premium, Ultimate
<strong>Offering:</strong> GitLab.com, Self-managed, GitLab Dedicated</p>
<blockquote>
<ul>
<li>Endpoint <code>/approvals</code> <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/353097">removed</a> in GitLab 16.0.</li>
</ul>
</blockquote>
<p>Configuration for
<a href="../user/project/merge_requests/approvals/index.md">approvals on all merge requests</a>
in the project. Must be authenticated for all endpoints.</p>
<h2>Group-level MR approvals</h2>
<p>DETAILS:
<strong>Status:</strong> Experiment</p>
<blockquote>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/428051">Introduced</a> in GitLab 16.7 <a href="../administration/feature_flags.md">with a flag</a> named <code>approval_group_rules</code>. Disabled by default. This feature is an <a href="../policy/experiment-beta-support.md">Experiment</a>.</li>
</ul>
</blockquote>
<p>FLAG:
On self-managed GitLab, by default this feature is not available. To make it available, an administrator can <a href="../administration/feature_flags.md">enable the feature flag</a> named <code>approval_group_rules</code>.
On GitLab.com and GitLab Dedicated, this feature is not available.
This feature is not ready for production use.</p>
<p>Group approval rules apply to all protected branches of projects belonging to the group. This feature is an <a href="../policy/experiment-beta-support.md">Experiment</a>.</p>
<h3>Get group-level approval rules</h3>
<blockquote>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/440638">Introduced</a> in GitLab 16.10.</li>
</ul>
</blockquote>
<p>Group admins can request information about a group's approval rules using the following endpoint:</p>
<p><code>plaintext
GET /groups/:id/approval_rules</code></p>
<p>Use the <code>page</code> and <code>per_page</code> <a href="rest/index.md#offset-based-pagination">pagination</a> parameters to restrict the list of approval rules.</p>
<p>Supported attributes:</p>
<p>| Attribute | Type              | Required | Description |
|-----------|-------------------|----------|-------------|
| <code>id</code>      | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |</p>
<p>Example request:</p>
<p><code>shell
curl --request GET \
  --header "PRIVATE-TOKEN: &lt;your_access_token&gt;" \
  --url "https://gitlab.example.com/api/v4/groups/29/approval_rules"</code></p>
<p>Example response:</p>
<p>```json
[
  {
    "id": 2,
    "name": "rule1",
    "rule_type": "any_approver",
    "eligible_approvers": [],
    "approvals_required": 3,
    "users": [],
    "groups": [],
    "contains_hidden_groups": false,
    "protected_branches": [],
    "applies_to_all_protected_branches": true
  },
  {
    "id": 3,
    "name": "rule2",
    "rule_type": "code_owner",
    "eligible_approvers": [],
    "approvals_required": 2,
    "users": [],
    "groups": [],
    "contains_hidden_groups": false,
    "protected_branches": [],
    "applies_to_all_protected_branches": true
  }
]</p>
<p>```</p>
<h3>Create group-level approval rules</h3>
<p>Group admins can create group level approval rules using the following endpoint:</p>
<p><code>plaintext
POST /groups/:id/approval_rules</code></p>
<p>Supported attributes:</p>
<p>| Attribute            | Type              | Required | Description |
|----------------------|-------------------|----------|-------------|
| <code>id</code>                 | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a group</a>. |
| <code>approvals_required</code> | integer           | Yes      | The number of required approvals for this rule. |
| <code>name</code>               | string            | Yes      | The name of the approval rule. |
| <code>group_ids</code>          | array             | No       | The IDs of groups as approvers. |
| <code>rule_type</code>          | string            | No       | The type of rule. <code>any_approver</code> is a pre-configured default rule with <code>approvals_required</code> at <code>0</code>. Other rules are <code>regular</code> (used for regular <a href="../user/project/merge_requests/approvals/rules.md">merge request approval rules</a>) and <code>report_approver</code>. <code>report_approver</code> is used automatically when an approval rule is created from configured and enabled <a href="../user/application_security/policies/scan-result-policies.md">merge request approval policies</a> and should not be used to create approval rule with this API. |
| <code>user_ids</code>           | array             | No       | The IDs of users as approvers. |</p>
<p>Example request:</p>
<p><code>shell
curl --request POST \
  --header "PRIVATE-TOKEN: &lt;your_access_token&gt;" \
  --url "https://gitlab.example.com/api/v4/groups/29/approval_rules?name=security&amp;approvals_required=2"</code></p>
<p>Example response:</p>
<p><code>json
{
  "id": 5,
  "name": "security",
  "rule_type": "any_approver",
  "eligible_approvers": [],
  "approvals_required": 2,
  "users": [],
  "groups": [],
  "contains_hidden_groups": false,
  "protected_branches": [
    {
      "id": 5,
      "name": "master",
      "push_access_levels": [
        {
          "id": 5,
          "access_level": 40,
          "access_level_description": "Maintainers",
          "deploy_key_id": null,
          "user_id": null,
          "group_id": null
        }
      ],
      "merge_access_levels": [
        {
          "id": 5,
          "access_level": 40,
          "access_level_description": "Maintainers",
          "user_id": null,
          "group_id": null
        }
      ],
      "allow_force_push": false,
      "unprotect_access_levels": [],
      "code_owner_approval_required": false,
      "inherited": false
    }
  ],
  "applies_to_all_protected_branches": true
}</code></p>
<h3>Update group-level approval rules</h3>
<blockquote>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/440639">Introduced</a> in GitLab 16.10.</li>
</ul>
</blockquote>
<p>Group admins can update group level approval rules using the following endpoint:</p>
<p><code>shell
PUT /groups/:id/approval_rules/:approval_rule_id</code></p>
<p>Supported attributes:</p>
<p>| Attribute            | Type              | Required | Description |
|----------------------|-------------------|----------|-------------|
| <code>approval_rule_id</code>.  | integer           | Yes      | The ID of the approval rule. |
| <code>id</code>                 | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a group</a>. |
| <code>approvals_required</code> | string            | No       | The number of required approvals for this rule. |
| <code>group_ids</code>          | integer           | No       | The IDs of users as approvers. |
| <code>name</code>               | string            | No       | The name of the approval rule. |
| <code>rule_type</code>          | array             | No       | The type of rule. <code>any_approver</code> is a pre-configured default rule with <code>approvals_required</code> at <code>0</code>. Other rules are <code>regular</code> (used for regular <a href="../user/project/merge_requests/approvals/rules.md">merge request approval rules</a>) and <code>report_approver</code>. <code>report_approver</code> is used automatically when an approval rule is created from configured and enabled <a href="../user/application_security/policies/scan-result-policies.md">merge request approval policies</a> and should not be used to create approval rule with this API. |
| <code>user_ids</code>           | array             | No       | The IDs of groups as approvers. |</p>
<p>Example request:</p>
<p><code>shell
curl --request PUT \
  --header "PRIVATE-TOKEN: &lt;your_access_token&gt;" \
  --url "https://gitlab.example.com/api/v4/groups/29/approval_rules/5?name=security2&amp;approvals_required=1"</code></p>
<p>Example response:</p>
<p><code>json
{
  "id": 5,
  "name": "security2",
  "rule_type": "any_approver",
  "eligible_approvers": [],
  "approvals_required": 1,
  "users": [],
  "groups": [],
  "contains_hidden_groups": false,
  "protected_branches": [
    {
      "id": 5,
      "name": "master",
      "push_access_levels": [
        {
          "id": 5,
          "access_level": 40,
          "access_level_description": "Maintainers",
          "deploy_key_id": null,
          "user_id": null,
          "group_id": null
        }
      ],
      "merge_access_levels": [
        {
          "id": 5,
          "access_level": 40,
          "access_level_description": "Maintainers",
          "user_id": null,
          "group_id": null
        }
      ],
      "allow_force_push": false,
      "unprotect_access_levels": [],
      "code_owner_approval_required": false,
      "inherited": false
    }
  ],
  "applies_to_all_protected_branches": true
}</code></p>
<h2>Project-level MR approvals</h2>
<blockquote>
<ul>
<li>Use the <a href="#get-project-level-rules">project level approval rules</a> to access this information.</li>
</ul>
</blockquote>
<p>You can request information about a project's approval configuration using the
following endpoint:</p>
<p><code>plaintext
GET /projects/:id/approvals</code></p>
<p>Supported attributes:</p>
<p>| Attribute | Type              | Required | Description |
|-----------|-------------------|----------|-------------|
| <code>id</code>      | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |</p>
<p><code>json
{
  "approvers": [], // Deprecated in GitLab 12.3, always returns empty
  "approver_groups": [], // Deprecated in GitLab 12.3, always returns empty
  "approvals_before_merge": 2, // Deprecated in GitLab 12.3, use Approval Rules instead
  "reset_approvals_on_push": true,
  "selective_code_owner_removals": false,
  "disable_overriding_approvers_per_merge_request": false,
  "merge_requests_author_approval": true,
  "merge_requests_disable_committers_approval": false,
  "require_password_to_approve": true
}</code></p>
<h3>Change configuration</h3>
<p>If you are allowed to, you can change approval configuration using the following
endpoint:</p>
<p><code>plaintext
POST /projects/:id/approvals</code></p>
<p>Supported attributes:</p>
<p>| Attribute                                        | Type              | Required | Description |
|--------------------------------------------------|-------------------|----------|-------------|
| <code>id</code>                                             | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |
| <code>approvals_before_merge</code> (deprecated)            | integer           | No       | How many approvals are required before a merge request can be merged. <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/11132">Deprecated</a> in GitLab 12.3. Use <a href="#create-project-level-rule">Approval Rules</a> instead. |
| <code>disable_overriding_approvers_per_merge_request</code> | boolean           | No       | Allow or prevent overriding approvers per merge request. |
| <code>merge_requests_author_approval</code>                 | boolean           | No       | Allow or prevent authors from self approving merge requests; <code>true</code> means authors can self approve. |
| <code>merge_requests_disable_committers_approval</code>     | boolean           | No       | Allow or prevent committers from self approving merge requests. |
| <code>require_password_to_approve</code>                    | boolean           | No       | Require approver to enter a password to authenticate before adding the approval. |
| <code>reset_approvals_on_push</code>                        | boolean           | No       | Reset approvals on a new push. |
| <code>selective_code_owner_removals</code>                  | boolean           | No       | Reset approvals from Code Owners if their files changed. Can be enabled only if <code>reset_approvals_on_push</code> is disabled. |</p>
<p><code>json
{
  "approvals_before_merge": 2, // Use Approval Rules instead
  "reset_approvals_on_push": true,
  "selective_code_owner_removals": false,
  "disable_overriding_approvers_per_merge_request": false,
  "merge_requests_author_approval": false,
  "merge_requests_disable_committers_approval": false,
  "require_password_to_approve": true
}</code></p>
<h3>Get project-level rules</h3>
<blockquote>
<ul>
<li>Pagination support <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/31011">introduced</a> in GitLab 15.3 <a href="../administration/feature_flags.md">with a flag</a> named <code>approval_rules_pagination</code>. Enabled by default.</li>
<li><code>applies_to_all_protected_branches</code> property was <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/335316">introduced</a> in GitLab 15.3.</li>
<li>Pagination support <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/366823">generally available</a> in GitLab 15.7. Feature flag <code>approval_rules_pagination</code> removed.</li>
<li><code>usernames</code> property was <a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/102446">introduced</a> in GitLab 15.8.</li>
</ul>
</blockquote>
<p>You can request information about a project's approval rules using the following endpoint:</p>
<p><code>plaintext
GET /projects/:id/approval_rules</code></p>
<p>Use the <code>page</code> and <code>per_page</code> <a href="rest/index.md#offset-based-pagination">pagination</a> parameters to restrict the list of approval rules.</p>
<p>Supported attributes:</p>
<p>| Attribute | Type              | Required | Description |
|-----------|-------------------|----------|-------------|
| <code>id</code>      | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |</p>
<p><code>json
[
  {
    "id": 1,
    "name": "security",
    "rule_type": "regular",
    "eligible_approvers": [
      {
        "id": 5,
        "name": "John Doe",
        "username": "jdoe",
        "state": "active",
        "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
        "web_url": "http://localhost/jdoe"
      },
      {
        "id": 50,
        "name": "Group Member 1",
        "username": "group_member_1",
        "state": "active",
        "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
        "web_url": "http://localhost/group_member_1"
      }
    ],
    "approvals_required": 3,
    "users": [
      {
        "id": 5,
        "name": "John Doe",
        "username": "jdoe",
        "state": "active",
        "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
        "web_url": "http://localhost/jdoe"
      }
    ],
    "groups": [
      {
        "id": 5,
        "name": "group1",
        "path": "group1",
        "description": "",
        "visibility": "public",
        "lfs_enabled": false,
        "avatar_url": null,
        "web_url": "http://localhost/groups/group1",
        "request_access_enabled": false,
        "full_name": "group1",
        "full_path": "group1",
        "parent_id": null,
        "ldap_cn": null,
        "ldap_access": null
      }
    ],
    "applies_to_all_protected_branches": false,
    "protected_branches": [
      {
        "id": 1,
        "name": "main",
        "push_access_levels": [
          {
            "access_level": 30,
            "access_level_description": "Developers + Maintainers"
          }
        ],
        "merge_access_levels": [
          {
            "access_level": 30,
            "access_level_description": "Developers + Maintainers"
          }
        ],
        "unprotect_access_levels": [
          {
            "access_level": 40,
            "access_level_description": "Maintainers"
          }
        ],
        "code_owner_approval_required": "false"
      }
    ],
    "contains_hidden_groups": false
  }
]</code></p>
<h3>Get a single project-level rule</h3>
<blockquote>
<ul>
<li><code>applies_to_all_protected_branches</code> property was <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/335316">introduced</a> in GitLab 15.3.</li>
<li><code>usernames</code> property was <a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/102446">introduced</a> in GitLab 15.8.</li>
</ul>
</blockquote>
<p>You can request information about a single project approval rules using the following endpoint:</p>
<p><code>plaintext
GET /projects/:id/approval_rules/:approval_rule_id</code></p>
<p>Supported attributes:</p>
<p>| Attribute          | Type              | Required | Description |
|--------------------|-------------------|----------|-------------|
| <code>id</code>               | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |
| <code>approval_rule_id</code> | integer           | Yes      | The ID of a approval rule. |</p>
<p><code>json
{
  "id": 1,
  "name": "security",
  "rule_type": "regular",
  "eligible_approvers": [
    {
      "id": 5,
      "name": "John Doe",
      "username": "jdoe",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/jdoe"
    },
    {
      "id": 50,
      "name": "Group Member 1",
      "username": "group_member_1",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/group_member_1"
    }
  ],
  "approvals_required": 3,
  "users": [
    {
      "id": 5,
      "name": "John Doe",
      "username": "jdoe",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/jdoe"
    }
  ],
  "groups": [
    {
      "id": 5,
      "name": "group1",
      "path": "group1",
      "description": "",
      "visibility": "public",
      "lfs_enabled": false,
      "avatar_url": null,
      "web_url": "http://localhost/groups/group1",
      "request_access_enabled": false,
      "full_name": "group1",
      "full_path": "group1",
      "parent_id": null,
      "ldap_cn": null,
      "ldap_access": null
    }
  ],
  "applies_to_all_protected_branches": false,
  "protected_branches": [
    {
      "id": 1,
      "name": "main",
      "push_access_levels": [
        {
          "access_level": 30,
          "access_level_description": "Developers + Maintainers"
        }
      ],
      "merge_access_levels": [
        {
          "access_level": 30,
          "access_level_description": "Developers + Maintainers"
        }
      ],
      "unprotect_access_levels": [
        {
          "access_level": 40,
          "access_level_description": "Maintainers"
        }
      ],
      "code_owner_approval_required": "false"
    }
  ],
  "contains_hidden_groups": false
}</code></p>
<h3>Create project-level rule</h3>
<blockquote>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/357300">Removed</a> the Vulnerability-Check feature in GitLab 15.0.</li>
<li><code>applies_to_all_protected_branches</code> property was <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/335316">introduced</a> in GitLab 15.3.</li>
<li><code>usernames</code> property was <a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/102446">introduced</a> in GitLab 15.8.</li>
</ul>
</blockquote>
<p>You can create project approval rules using the following endpoint:</p>
<p><code>plaintext
POST /projects/:id/approval_rules</code></p>
<p>Supported attributes:</p>
<p>| Attribute                           | Type              | Required | Description |
|-------------------------------------|-------------------|----------|-------------|
| <code>id</code>                                | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |
| <code>approvals_required</code>                | integer           | Yes      | The number of required approvals for this rule. |
| <code>name</code>                              | string            | Yes      | The name of the approval rule. |
| <code>applies_to_all_protected_branches</code> | boolean           | No       | Whether the rule is applied to all protected branches. If set to <code>true</code>, the value of <code>protected_branch_ids</code> is ignored. Default is <code>false</code>. <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/335316">Introduced</a> in GitLab 15.3. |
| <code>group_ids</code>                         | Array             | No       | The IDs of groups as approvers. |
| <code>protected_branch_ids</code>              | Array             | No       | The IDs of protected branches to scope the rule by. To identify the ID, <a href="protected_branches.md#list-protected-branches">use the API</a>. |
| <code>report_type</code>                       | string            | No       | The report type required when the rule type is <code>report_approver</code>. The supported report types are <code>license_scanning</code> <a href="../update/deprecations.md#license-check-and-the-policies-tab-on-the-license-compliance-page">(Deprecated in GitLab 15.9)</a> and <code>code_coverage</code>. |
| <code>rule_type</code>                         | string            | No       | The type of rule. <code>any_approver</code> is a pre-configured default rule with <code>approvals_required</code> at <code>0</code>. Other rules are <code>regular</code> (used for regular <a href="../user/project/merge_requests/approvals/rules.md">merge request approval rules</a>) and <code>report_approver</code>. <code>report_approver</code> is used automatically when an approval rule is created from configured and enabled <a href="../user/application_security/policies/scan-result-policies.md">merge request approval policies</a> and should not be used to create approval rule with this API. |
| <code>user_ids</code>                          | Array             | No       | The IDs of users as approvers. If you provide both <code>user_ids</code> and <code>usernames</code>, both lists of users are added. |
| <code>usernames</code>                         | string array      | No       | The usernames of approvers for this rule (same as <code>user_ids</code> but requires a list of usernames). If you provide both <code>user_ids</code> and <code>usernames</code>, both lists of users are added. |</p>
<p><code>json
{
  "id": 1,
  "name": "security",
  "rule_type": "regular",
  "eligible_approvers": [
    {
      "id": 2,
      "name": "John Doe",
      "username": "jdoe",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/jdoe"
    },
    {
      "id": 50,
      "name": "Group Member 1",
      "username": "group_member_1",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/group_member_1"
    }
  ],
  "approvals_required": 1,
  "users": [
    {
      "id": 2,
      "name": "John Doe",
      "username": "jdoe",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/jdoe"
    }
  ],
  "groups": [
    {
      "id": 5,
      "name": "group1",
      "path": "group1",
      "description": "",
      "visibility": "public",
      "lfs_enabled": false,
      "avatar_url": null,
      "web_url": "http://localhost/groups/group1",
      "request_access_enabled": false,
      "full_name": "group1",
      "full_path": "group1",
      "parent_id": null,
      "ldap_cn": null,
      "ldap_access": null
    }
  ],
  "applies_to_all_protected_branches": false,
  "protected_branches": [
    {
      "id": 1,
      "name": "main",
      "push_access_levels": [
        {
          "access_level": 30,
          "access_level_description": "Developers + Maintainers"
        }
      ],
      "merge_access_levels": [
        {
          "access_level": 30,
          "access_level_description": "Developers + Maintainers"
        }
      ],
      "unprotect_access_levels": [
        {
          "access_level": 40,
          "access_level_description": "Maintainers"
        }
      ],
      "code_owner_approval_required": "false"
    }
  ],
  "contains_hidden_groups": false
}</code></p>
<p>You can increase the default number of 0 required approvers like this:</p>
<p><code>shell
curl --request POST \
  --header "PRIVATE-TOKEN: &lt;your_access_token&gt;" \
  --header 'Content-Type: application/json' \
  --data '{"name": "Any name", "rule_type": "any_approver", "approvals_required": 2}'</code></p>
<p>Another example is creating an additional, user-specific rule:</p>
<p><code>shell
curl --request POST \
  --header "PRIVATE-TOKEN: &lt;your_access_token&gt;" \
  --header 'Content-Type: application/json' \
  --data '{"name": "Name of your rule", "approvals_required": 3, "user_ids": [123, 456, 789]}' \
  --url "https://gitlab.example.com/api/v4/projects/&lt;project_id&gt;/approval_rules"</code></p>
<h3>Update project-level rule</h3>
<blockquote>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/357300">Removed</a> the Vulnerability-Check feature in GitLab 15.0.</li>
<li><code>applies_to_all_protected_branches</code> property was <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/335316">introduced</a> in GitLab 15.3.</li>
<li><code>usernames</code> property was <a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/102446">introduced</a> in GitLab 15.8.</li>
</ul>
</blockquote>
<p>You can update project approval rules using the following endpoint:</p>
<p><code>plaintext
PUT /projects/:id/approval_rules/:approval_rule_id</code></p>
<p>NOTE:
Approvers and groups (except hidden groups not in the <code>users</code> or <code>groups</code>
parameters) are <strong>removed</strong>. Hidden groups are private groups the user doesn't
have permission to view. Hidden groups are not removed by default unless the
<code>remove_hidden_groups</code> parameter is <code>true</code>. This ensures hidden groups are
not removed unintentionally when a user updates an approval rule.</p>
<p>Supported attributes:</p>
<p>| Attribute                           | Type              | Required | Description |
|-------------------------------------|-------------------|----------|-------------|
| <code>id</code>                                | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |
| <code>approvals_required</code>                | integer           | Yes      | The number of required approvals for this rule. |
| <code>approval_rule_id</code>                  | integer           | Yes      | The ID of a approval rule. |
| <code>name</code>                              | string            | Yes      | The name of the approval rule. |
| <code>applies_to_all_protected_branches</code> | boolean           | No       | Whether the rule is applied to all protected branches. If set to <code>true</code>, the value of <code>protected_branch_ids</code> is ignored. Default is <code>false</code>. <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/335316">Introduced</a> in GitLab 15.3. |
| <code>group_ids</code>                         | Array             | No       | The IDs of groups as approvers. |
| <code>protected_branch_ids</code>              | Array             | No       | The IDs of protected branches to scope the rule by. To identify the ID, <a href="protected_branches.md#list-protected-branches">use the API</a>. |
| <code>remove_hidden_groups</code>              | boolean           | No       | Whether hidden groups should be removed from approval rule. |
| <code>user_ids</code>                          | Array             | No       | The IDs of users as approvers. If you provide both <code>user_ids</code> and <code>usernames</code>, both lists of users are added. |
| <code>usernames</code>                         | string array      | No       | The usernames of approvers for this rule (same as <code>user_ids</code> but requires a list of usernames). If you provide both <code>user_ids</code> and <code>usernames</code>, both lists of users are added. |</p>
<p><code>json
{
  "id": 1,
  "name": "security",
  "rule_type": "regular",
  "eligible_approvers": [
    {
      "id": 2,
      "name": "John Doe",
      "username": "jdoe",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/jdoe"
    },
    {
      "id": 50,
      "name": "Group Member 1",
      "username": "group_member_1",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/group_member_1"
    }
  ],
  "approvals_required": 1,
  "users": [
    {
      "id": 2,
      "name": "John Doe",
      "username": "jdoe",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/jdoe"
    }
  ],
  "groups": [
    {
      "id": 5,
      "name": "group1",
      "path": "group1",
      "description": "",
      "visibility": "public",
      "lfs_enabled": false,
      "avatar_url": null,
      "web_url": "http://localhost/groups/group1",
      "request_access_enabled": false,
      "full_name": "group1",
      "full_path": "group1",
      "parent_id": null,
      "ldap_cn": null,
      "ldap_access": null
    }
  ],
  "applies_to_all_protected_branches": false,
  "protected_branches": [
    {
      "id": 1,
      "name": "main",
      "push_access_levels": [
        {
          "access_level": 30,
          "access_level_description": "Developers + Maintainers"
        }
      ],
      "merge_access_levels": [
        {
          "access_level": 30,
          "access_level_description": "Developers + Maintainers"
        }
      ],
      "unprotect_access_levels": [
        {
          "access_level": 40,
          "access_level_description": "Maintainers"
        }
      ],
      "code_owner_approval_required": "false"
    }
  ],
  "contains_hidden_groups": false
}</code></p>
<h3>Delete project-level rule</h3>
<p>You can delete project approval rules using the following endpoint:</p>
<p><code>plaintext
DELETE /projects/:id/approval_rules/:approval_rule_id</code></p>
<p>Supported attributes:</p>
<p>| Attribute          | Type              | Required | Description |
|--------------------|-------------------|----------|-------------|
| <code>id</code>               | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |
| <code>approval_rule_id</code> | integer           | Yes      | The ID of a approval rule. |</p>
<h2>Merge request-level MR approvals</h2>
<p>Configuration for approvals on a specific merge request. Must be authenticated for all endpoints.</p>
<p>You can request information about a merge request's approval status using the
following endpoint:</p>
<p><code>plaintext
GET /projects/:id/merge_requests/:merge_request_iid/approvals</code></p>
<p>Supported attributes:</p>
<p>| Attribute           | Type              | Required | Description |
|---------------------|-------------------|----------|-------------|
| <code>id</code>                | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |
| <code>merge_request_iid</code> | integer           | Yes      | The IID of the merge request. |</p>
<p><code>json
{
  "id": 5,
  "iid": 5,
  "project_id": 1,
  "title": "Approvals API",
  "description": "Test",
  "state": "opened",
  "created_at": "2016-06-08T00:19:52.638Z",
  "updated_at": "2016-06-08T21:20:42.470Z",
  "merge_status": "cannot_be_merged",
  "approvals_required": 2,
  "approvals_left": 1,
  "approved_by": [
    {
      "user": {
        "name": "Administrator",
        "username": "root",
        "id": 1,
        "state": "active",
        "avatar_url": "http://www.gravatar.com/avatar/e64c7d89f26bd1972efa854d13d7dd61?s=80\u0026d=identicon",
        "web_url": "http://localhost:3000/root"
      }
    }
  ]
}</code></p>
<h3>Get the approval state of merge requests</h3>
<p>You can request information about a merge request's approval state by using the following endpoint:</p>
<p><code>plaintext
GET /projects/:id/merge_requests/:merge_request_iid/approval_state</code></p>
<p>The <code>approval_rules_overwritten</code> are <code>true</code> if the merge request level rules
are created for the merge request. If there are none, it is <code>false</code>.</p>
<p>This includes additional information about the users who have already approved
(<code>approved_by</code>) and whether a rule is already approved (<code>approved</code>).</p>
<p>Supported attributes:</p>
<p>| Attribute           | Type              | Required | Description |
|---------------------|-------------------|----------|-------------|
| <code>id</code>                | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |
| <code>merge_request_iid</code> | integer           | Yes      | The IID of the merge request. |</p>
<p><code>json
{
  "approval_rules_overwritten": true,
  "rules": [
    {
      "id": 1,
      "name": "Ruby",
      "rule_type": "regular",
      "eligible_approvers": [
        {
          "id": 4,
          "name": "John Doe",
          "username": "jdoe",
          "state": "active",
          "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
          "web_url": "http://localhost/jdoe"
        }
      ],
      "approvals_required": 2,
      "users": [
        {
          "id": 4,
          "name": "John Doe",
          "username": "jdoe",
          "state": "active",
          "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
          "web_url": "http://localhost/jdoe"
        }
      ],
      "groups": [],
      "contains_hidden_groups": false,
      "approved_by": [
        {
          "id": 4,
          "name": "John Doe",
          "username": "jdoe",
          "state": "active",
          "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
          "web_url": "http://localhost/jdoe"
        }
      ],
      "source_rule": null,
      "approved": true,
      "overridden": false
    }
  ]
}</code></p>
<h3>Get merge request level rules</h3>
<blockquote>
<ul>
<li>Pagination support <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/31011">introduced</a> in GitLab 15.3 <a href="../administration/feature_flags.md">with a flag</a> named <code>approval_rules_pagination</code>. Enabled by default.</li>
<li>Pagination support <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/366823">generally available</a> in GitLab 15.7. Feature flag <code>approval_rules_pagination</code> removed.</li>
</ul>
</blockquote>
<p>You can request information about a merge request's approval rules using the following endpoint:</p>
<p><code>plaintext
GET /projects/:id/merge_requests/:merge_request_iid/approval_rules</code></p>
<p>Use the <code>page</code> and <code>per_page</code> <a href="rest/index.md#offset-based-pagination">pagination</a> parameters to restrict the list of approval rules.</p>
<p>Supported attributes:</p>
<p>| Attribute           | Type              | Required | Description |
|---------------------|-------------------|----------|-------------|
| <code>id</code>                | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |
| <code>merge_request_iid</code> | integer           | Yes      | The IID of the merge request. |</p>
<p><code>json
[
  {
    "id": 1,
    "name": "security",
    "rule_type": "regular",
    "eligible_approvers": [
      {
        "id": 5,
        "name": "John Doe",
        "username": "jdoe",
        "state": "active",
        "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
        "web_url": "http://localhost/jdoe"
      },
      {
        "id": 50,
        "name": "Group Member 1",
        "username": "group_member_1",
        "state": "active",
        "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
        "web_url": "http://localhost/group_member_1"
      }
    ],
    "approvals_required": 3,
    "source_rule": null,
    "users": [
      {
        "id": 5,
        "name": "John Doe",
        "username": "jdoe",
        "state": "active",
        "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
        "web_url": "http://localhost/jdoe"
      }
    ],
    "groups": [
      {
        "id": 5,
        "name": "group1",
        "path": "group1",
        "description": "",
        "visibility": "public",
        "lfs_enabled": false,
        "avatar_url": null,
        "web_url": "http://localhost/groups/group1",
        "request_access_enabled": false,
        "full_name": "group1",
        "full_path": "group1",
        "parent_id": null,
        "ldap_cn": null,
        "ldap_access": null
      }
    ],
    "contains_hidden_groups": false,
    "overridden": false
  }
]</code></p>
<h3>Get a single merge request level rule</h3>
<p>You can request information about a single merge request approval rule using the following endpoint:</p>
<p><code>plaintext
GET /projects/:id/merge_requests/:merge_request_iid/approval_rules/:approval_rule_id</code></p>
<p>Supported attributes:</p>
<p>| Attribute           | Type              | Required | Description |
|---------------------|-------------------|----------|-------------|
| <code>id</code>                | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |
| <code>approval_rule_id</code>  | integer           | Yes      | The ID of an approval rule. |
| <code>merge_request_iid</code> | integer           | Yes      | The IID of a merge request. |</p>
<p><code>json
{
  "id": 1,
  "name": "security",
  "rule_type": "regular",
  "eligible_approvers": [
    {
      "id": 5,
      "name": "John Doe",
      "username": "jdoe",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/jdoe"
    },
    {
      "id": 50,
      "name": "Group Member 1",
      "username": "group_member_1",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/group_member_1"
    }
  ],
  "approvals_required": 3,
  "source_rule": null,
  "users": [
    {
      "id": 5,
      "name": "John Doe",
      "username": "jdoe",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/jdoe"
    }
  ],
  "groups": [
    {
      "id": 5,
      "name": "group1",
      "path": "group1",
      "description": "",
      "visibility": "public",
      "lfs_enabled": false,
      "avatar_url": null,
      "web_url": "http://localhost/groups/group1",
      "request_access_enabled": false,
      "full_name": "group1",
      "full_path": "group1",
      "parent_id": null,
      "ldap_cn": null,
      "ldap_access": null
    }
  ],
  "contains_hidden_groups": false,
  "overridden": false
}</code></p>
<h3>Create merge request level rule</h3>
<p>You can create merge request approval rules using the following endpoint:</p>
<p><code>plaintext
POST /projects/:id/merge_requests/:merge_request_iid/approval_rules</code></p>
<p>Supported attributes:</p>
<p>| Attribute                  | Type              | Required               | Description                                                                  |
|----------------------------|-------------------|------------------------|------------------------------------------------------------------------------|
| <code>id</code>                       | integer or string | Yes | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a> |
| <code>approvals_required</code>       | integer           | Yes | The number of required approvals for this rule.                              |
| <code>merge_request_iid</code>        | integer           | Yes | The IID of the merge request.                                                |
| <code>name</code>                     | string            | Yes | The name of the approval rule.                                               |
| <code>approval_project_rule_id</code> | integer           | No | The ID of a project-level approval rule.                                     |
| <code>group_ids</code>                | Array             | No | The IDs of groups as approvers.                                              |
| <code>user_ids</code>                 | Array             | No | The IDs of users as approvers. If you provide both <code>user_ids</code> and <code>usernames</code>, both lists of users are added. |
| <code>usernames</code>                | string array      | No | The usernames of approvers for this rule (same as <code>user_ids</code> but requires a list of usernames). If you provide both <code>user_ids</code> and <code>usernames</code>, both lists of users are added. |</p>
<p>NOTE:
When <code>approval_project_rule_id</code> is set, the <code>name</code>, <code>users</code> and
<code>groups</code> of project-level rule are copied. The <code>approvals_required</code> specified
is used.</p>
<p><code>json
{
  "id": 1,
  "name": "security",
  "rule_type": "regular",
  "eligible_approvers": [
    {
      "id": 2,
      "name": "John Doe",
      "username": "jdoe",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/jdoe"
    },
    {
      "id": 50,
      "name": "Group Member 1",
      "username": "group_member_1",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/group_member_1"
    }
  ],
  "approvals_required": 1,
  "source_rule": null,
  "users": [
    {
      "id": 2,
      "name": "John Doe",
      "username": "jdoe",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/jdoe"
    }
  ],
  "groups": [
    {
      "id": 5,
      "name": "group1",
      "path": "group1",
      "description": "",
      "visibility": "public",
      "lfs_enabled": false,
      "avatar_url": null,
      "web_url": "http://localhost/groups/group1",
      "request_access_enabled": false,
      "full_name": "group1",
      "full_path": "group1",
      "parent_id": null,
      "ldap_cn": null,
      "ldap_access": null
    }
  ],
  "contains_hidden_groups": false,
  "overridden": false
}</code></p>
<h3>Update merge request level rule</h3>
<p>You can update merge request approval rules using the following endpoint:</p>
<p><code>plaintext
PUT /projects/:id/merge_requests/:merge_request_iid/approval_rules/:approval_rule_id</code></p>
<p>Approvers and groups not in the <code>users</code> or <code>groups</code> parameters are <strong>removed</strong>.</p>
<p>You can't update <code>report_approver</code> or <code>code_owner</code> rules, as these rules are system-generated.</p>
<p>Supported attributes:</p>
<p>| Attribute              | Type              | Required               | Description                                                                   |
|------------------------|-------------------|------------------------|-------------------------------------------------------------------------------|
| <code>id</code>                   | integer or string | Yes | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |
| <code>approval_rule_id</code>     | integer           | Yes | The ID of an approval rule.                                                   |
| <code>merge_request_iid</code>    | integer           | Yes | The IID of a merge request.                                                   |
| <code>approvals_required</code>   | integer           |  No | The number of required approvals for this rule.                               |
| <code>group_ids</code>            | Array             | No | The IDs of groups as approvers.                                               |
| <code>name</code>                 | string            |  No | The name of the approval rule.                                                |
| <code>remove_hidden_groups</code> | boolean           | No | Whether hidden groups should be removed.                                      |
| <code>user_ids</code>             | Array             | No | The IDs of users as approvers. If you provide both <code>user_ids</code> and <code>usernames</code>, both lists of users are added. |
| <code>usernames</code>            | string array      | No | The usernames of approvers for this rule (same as <code>user_ids</code> but requires a list of usernames). If you provide both <code>user_ids</code> and <code>usernames</code>, both lists of users are added. |</p>
<p><code>json
{
  "id": 1,
  "name": "security",
  "rule_type": "regular",
  "eligible_approvers": [
    {
      "id": 2,
      "name": "John Doe",
      "username": "jdoe",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/jdoe"
    },
    {
      "id": 50,
      "name": "Group Member 1",
      "username": "group_member_1",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/group_member_1"
    }
  ],
  "approvals_required": 1,
  "source_rule": null,
  "users": [
    {
      "id": 2,
      "name": "John Doe",
      "username": "jdoe",
      "state": "active",
      "avatar_url": "https://www.gravatar.com/avatar/0?s=80&amp;d=identicon",
      "web_url": "http://localhost/jdoe"
    }
  ],
  "groups": [
    {
      "id": 5,
      "name": "group1",
      "path": "group1",
      "description": "",
      "visibility": "public",
      "lfs_enabled": false,
      "avatar_url": null,
      "web_url": "http://localhost/groups/group1",
      "request_access_enabled": false,
      "full_name": "group1",
      "full_path": "group1",
      "parent_id": null,
      "ldap_cn": null,
      "ldap_access": null
    }
  ],
  "contains_hidden_groups": false,
  "overridden": false
}</code></p>
<h3>Delete merge request level rule</h3>
<p>You can delete merge request approval rules using the following endpoint:</p>
<p><code>plaintext
DELETE /projects/:id/merge_requests/:merge_request_iid/approval_rules/:approval_rule_id</code></p>
<p>You can't update <code>report_approver</code> or <code>code_owner</code> rules, as these rules are system-generated.</p>
<p>Supported attributes:</p>
<p>| Attribute           | Type              | Required               | Description                                                                   |
|---------------------|-------------------|------------------------|-------------------------------------------------------------------------------|
| <code>id</code>                | integer or string | Yes | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |
| <code>approval_rule_id</code>  | integer           | Yes | The ID of an approval rule.                                                   |
| <code>merge_request_iid</code> | integer           | Yes | The IID of the merge request.                                                 |</p>
<h2>Approve merge request</h2>
<p>If you are allowed to, you can approve a merge request using the following
endpoint:</p>
<p><code>plaintext
POST /projects/:id/merge_requests/:merge_request_iid/approve</code></p>
<p>Supported attributes:</p>
<p>| Attribute           | Type              | Required | Description |
|---------------------|-------------------|----------|-------------|
| <code>id</code>                | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |
| <code>approval_password</code> | string            | No       | Current user's password. Required if <a href="../user/project/merge_requests/approvals/settings.md#require-user-re-authentication-to-approve"><strong>Require user password to approve</strong></a> is enabled in the project settings. |
| <code>merge_request_iid</code> | integer           | Yes      | The IID of the merge request. |
| <code>sha</code>               | string            | No       | The <code>HEAD</code> of the merge request. |</p>
<p>The <code>sha</code> parameter works in the same way as
when <a href="merge_requests.md#merge-a-merge-request">accepting a merge request</a>: if it is passed, then it must
match the current HEAD of the merge request for the approval to be added. If it
does not match, the response code is <code>409</code>.</p>
<p><code>json
{
  "id": 5,
  "iid": 5,
  "project_id": 1,
  "title": "Approvals API",
  "description": "Test",
  "state": "opened",
  "created_at": "2016-06-08T00:19:52.638Z",
  "updated_at": "2016-06-09T21:32:14.105Z",
  "merge_status": "can_be_merged",
  "approvals_required": 2,
  "approvals_left": 0,
  "approved_by": [
    {
      "user": {
        "name": "Administrator",
        "username": "root",
        "id": 1,
        "state": "active",
        "avatar_url": "http://www.gravatar.com/avatar/e64c7d89f26bd1972efa854d13d7dd61?s=80\u0026d=identicon",
        "web_url": "http://localhost:3000/root"
      }
    },
    {
      "user": {
        "name": "Nico Cartwright",
        "username": "ryley",
        "id": 2,
        "state": "active",
        "avatar_url": "http://www.gravatar.com/avatar/cf7ad14b34162a76d593e3affca2adca?s=80\u0026d=identicon",
        "web_url": "http://localhost:3000/ryley"
      }
    }
  ]
}</code></p>
<h2>Unapprove merge request</h2>
<p>If you did approve a merge request, you can unapprove it using the following
endpoint:</p>
<p><code>plaintext
POST /projects/:id/merge_requests/:merge_request_iid/unapprove</code></p>
<p>Supported attributes:</p>
<p>| Attribute           | Type              | Required | Description |
|---------------------|-------------------|----------|-------------|
| <code>id</code>                | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of a project</a>. |
| <code>merge_request_iid</code> | integer           | Yes      | The IID of a merge request. |</p>
<h2>Reset approvals of a merge request</h2>
<p>Clear all approvals of merge request.</p>
<p>Available only for <a href="../user/project/settings/project_access_tokens.md#bot-users-for-projects">bot users</a>
based on project or group tokens. Users without bot permissions receive a <code>401 Unauthorized</code> response.</p>
<p><code>plaintext
PUT /projects/:id/merge_requests/:merge_request_iid/reset_approvals</code></p>
<p>| Attribute           | Type              | Required | Description |
|---------------------|-------------------|----------|-------------|
| <code>id</code>                | integer or string | Yes      | The ID or <a href="rest/index.md#namespaced-path-encoding">URL-encoded path of the project</a> owned by the authenticated user. |
| <code>merge_request_iid</code> | integer           | Yes      | The internal ID of the merge request. |</p>
<p><code>shell
curl --request PUT \
  --header "PRIVATE-TOKEN: &lt;your_access_token&gt;" \
  --url "https://gitlab.example.com/api/v4/projects/76/merge_requests/1/reset_approvals"</code></p>
</body>
</html>